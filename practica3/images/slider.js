define(['frameworks/bundle'],function () {;(function($,w,d) {var sliderModel=fifa.model.extend({initialize:function(options) {var _this=this;fifa.model.prototype.initialize.apply(_this,[options]);},onMove:function(obj_slider,obj,desired_step) {this.triggerView('move',obj_slider,obj,desired_step);},photostreamOnShowAdv:function() {this.triggerView('toggleHiddenAdv',false);},photostreamOnHideAdv:function() {this.triggerView('toggleHiddenAdv',true);},onMoveToPagingIdx:function(pagingIdx) {this.triggerView('moveToPagingIdx',pagingIdx);},name:'slider',view_name:'slider:view'});w.models.slider=new sliderModel({bind:['move','itemClick','showAdv','hideAdv','photostream:hideAdv','photostream:showAdv','moveToPagingIdx']});}(window.jQuery||window.jm,window,document));;(function($,w,d) {var sliderView=fifa.view.extend({initialize:function(options) {var _this=this;fifa.view.prototype.initialize.apply(_this,[options]);_this.triggerMe('init');},coreOnWindowResize:function(screen_width) {var _this=this;_this.triggerMe('init',true);_this.triggerMe('sizeReinit');},onSizeReinit:function() {var _this=this;_this.$el.each(function() {var obj_slider=$(this).data('obj_slider'),anim_obj={},cur_page=obj_slider.$el.attr('data-currentpage')||1;var step=_this.getStep(obj_slider,cur_page);obj_slider.actual_step=cur_page - 1;if("ar"=="es") {anim_obj['right']='-' + (step * obj_slider.item_width) + 'px';}else {anim_obj['left']='-' + (step * obj_slider.item_width) + 'px';}obj_slider.$list.css(anim_obj);})},onInit:function(is_reinit) {var _this=this,screenWidth=fifa.getScreenWidth();_this.$el.each(function() {var $el=$(this);var _obj={$el:null,items_count:-1,items_per_page:-1,$nav:null,$pagePosCounter:null,$list:null,item_width:null,steps:[],max_steps:0,actual_step:0};_obj.$el=$el;_obj.$list=$el.find('.slider-list');_obj.$li=_obj.$list.children('li');_obj.items_count=parseInt($el.attr('data-itemscount')||_obj.$li.length,10);_obj.items_per_page=parseInt($el.attr('data-itemsperpage')||_obj.$li.length,10);_obj.$nav=$el.find('.slider-nav');_obj.$pagePosCounter=_obj.$nav.find('.page-position-wrap .current-page');_obj.item_width=fifa.is_mobile ? (screenWidth / _obj.items_per_page):_obj.$li.outerWidth(true);if(_obj.items_count) {_obj.$list.width(_obj.item_width * _obj.items_count);}if(fifa.is_mobile) {_obj.$li.css('width',_obj.item_width + 'px');$el.width(screenWidth);}_this.triggerMe('navInit',_obj);var $sliderdefault=is_reinit ? []:_obj.$list.find("li[data-sliderdefault='true']");if($sliderdefault.length>0) {var index=$sliderdefault.index();$sliderdefault.addClass("selected");var page=parseInt(index / _obj.items_per_page,10) + 1;_this.triggerMe('move',_obj,null,page);}});},onNavInit:function(obj_slider) {var _this=this,items=obj_slider.items_count,items_mod=-1;while (items>0) {items_mod=items % obj_slider.items_per_page;if(items_mod>0) {obj_slider.steps.push(items_mod);items -= items_mod;}obj_slider.steps.push(obj_slider.items_per_page);items=items - obj_slider.items_per_page;}obj_slider.steps.reverse();obj_slider.max_steps=obj_slider.steps.length - 1;obj_slider.$nav_items=obj_slider.$nav.find('.slider-nav-elm').off('click.slider').on('click.slider',function(e) {e.preventDefault();if(this.className.indexOf(' disabled')>-1) { return;}_this.triggerModel('move',obj_slider,this);});obj_slider.$el.data('obj_slider',obj_slider);if(obj_slider.items_per_page==1) {_this.notifyCurrendPagingIdx(obj_slider,obj_slider.actual_step + 1);}},getStep:function(obj_slider,page) {var step=0;if(page>1) {for (var i=1; i<page; i++) {step += obj_slider.steps[i];}}return step;},onMove:function(obj_slider,nav_item,desired_step,disableNotifications) {var _this=this,className=nav_item ? nav_item.className:'',is_page=(desired_step!=undefined)||(className.indexOf('nav-page-')>-1),is_move_next=className.indexOf('nav-prev')===-1,step=0,anim_obj={};if(is_page) {var page=nav_item ? nav_item.getAttribute('data-page'):desired_step;if(!page) { return;}page=parseInt(page,10);if(page>(obj_slider.max_steps + 1)) { return;}if(page===(obj_slider.actual_step + 1)) { return;}obj_slider.actual_step=page - 1;step=_this.getStep(obj_slider,page);if("ar"=="es") {anim_obj['right']='-' + (step * obj_slider.item_width);}else {anim_obj['left']='-' + (step * obj_slider.item_width);}obj_slider.$list.animate(anim_obj);}else {if(is_move_next) {step=obj_slider.steps[++obj_slider.actual_step];}else {step=obj_slider.steps[obj_slider.actual_step--];}if("ar"=="es") {anim_obj['right']=(is_move_next ? '-':'+') + '=' + (step * obj_slider.item_width);}else {anim_obj['left']=(is_move_next ? '-':'+') + '=' + (step * obj_slider.item_width);}obj_slider.$list.animate(anim_obj);}fifa.dispatcher.trigger('core:view:unveilImages',obj_slider.$list);obj_slider.$nav_items.removeClass('disabled');if(obj_slider.actual_step<=0) {obj_slider.$nav_items.filter('.nav-prev').addClass('disabled');obj_slider.$nav_items.filter('.nav-next').removeClass('disabled');}else if(obj_slider.actual_step>=obj_slider.max_steps) {obj_slider.$nav_items.filter('.nav-prev').removeClass('disabled');obj_slider.$nav_items.filter('.nav-next').addClass('disabled');}obj_slider.$el.attr("data-currentpage",(obj_slider.actual_step + 1)).find(".slider-nav-elm").removeClass("active").end().find(".nav-page-" + (obj_slider.actual_step + 1)).addClass("active");if(obj_slider.$pagePosCounter) {obj_slider.$pagePosCounter.text(obj_slider.actual_step + 1);}if(obj_slider.items_per_page==1&&!disableNotifications) {_this.notifyCurrendPagingIdx(obj_slider,obj_slider.actual_step + 1);}},notifyCurrendPagingIdx:function(obj_slider,listIdx) {var _this=this,pagingId=obj_slider.$list.find('li:nth-child(' + listIdx + ')').attr('paging-id');if(pagingId) {_this.triggerModel('movedToPagingIdx',pagingId);}},onItemClick:function(e) {var $target=$(e.target).closest('li');if($target.hasClass('noclick')||$target.closest('.noclick').is('li')) {return;}if($target.hasClass('selected')) {e.preventDefault();return;}this.triggerMe('setSelected',$target);this.triggerModel('itemClick',e,$target.find('img').attr('data-idx'));},onSetSelected:function($target) {$('.selected',this.$list).removeClass('selected');if($target.length) {$target.addClass('selected');}},onToggleHiddenAdv:function(hidden) {$('.adv-overlay',this.$el).toggleClass('hidden',hidden);},onMoveToPagingIdx:function(pagingIdx) {var _this=this;_this.$el.each(function(i,e) {var obj_slider=$(this).data('obj_slider');var node=obj_slider.$list.find('li[paging-id=' + pagingIdx + ']');if(node) {_this.triggerMe('move',obj_slider,null,node.index() + 1,true);}});},photostreamOnSetPhoto:function(index) {var _this=this,obj_slider=_this.$el.data('obj_slider');if(!obj_slider) { return;}$('.selected',obj_slider.$list).removeClass('selected');obj_slider.$el.find('.slider-list li:eq(' + (index - 1) + ')').addClass('selected');var desiredStep=Math.floor((index - 1) / obj_slider.items_per_page);_this.triggerMe('move',obj_slider,null,desiredStep + 1);},events:{'click .slider-list':'onItemClick'},name:'slider:view',model_name:'slider'});w.views.slider=new sliderView({el:'.slider',bind:['init','navInit','sizeReinit','move','photostream:setPhoto','toggleHiddenAdv','moveToPagingIdx','core:windowResize','setSelected']});}(window.jQuery||window.jm,window,document)); });
